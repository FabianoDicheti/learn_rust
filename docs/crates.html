<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecossistema e Crates - Rust Básico em PTBR</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <img src="images/rust_logo_gear.png" alt="Logo do Rust">
                    <img src="images/ferris_crab.png" alt="Ferris - Mascote do Rust">
                    <h1>Rust Básico em PTBR</h1>
                </div>
            </div>
        </div>
    </header>

    <nav class="nav">
        <div class="container">
            <ul>
                <li><a href="index.html">Início</a></li>
                <li><a href="instalacao.html">Instalação</a></li>
                <li><a href="primeiro-projeto.html">Iniciando Um Projeto</a></li>
                <li><a href="fundamentos.html">Fundamentos</a></li>
                <li><a href="ownership.html">Ownership</a></li>
                <li><a href="testes.html">Testes</a></li>
                <li><a href="crates.html" class="active">Crates</a></li>
                <li><a href="recursos.html">Recursos</a></li>
            </ul>
        </div>
    </nav>

    <main class="main container">
        <h1 class="section-title">Ecossistema e Crates</h1>
        
        <p>Nenhum projeto vive isolado! Em Rust, as bibliotecas são chamadas de <strong>crates</strong>, e você as encontra no <a href="https://crates.io" target="_blank">crates.io</a> - o repositório oficial de pacotes Rust. Com mais de 100.000 crates disponíveis, há uma solução para quase tudo!</p>

        <div class="info-box">
            <h4><i class="fas fa-cube"></i> O que são Crates?</h4>
            <p>Um <strong>crate</strong> é uma unidade de compilação em Rust. Pode ser uma biblioteca (lib) que outros projetos usam, ou um binário (bin) que pode ser executado. O Cargo gerencia tudo automaticamente!</p>
        </div>

        <h2 class="section-subtitle">Adicionando Dependências</h2>
        
        <p>Adicionar uma crate ao seu projeto é incrivelmente simples com o Cargo:</p>
        
        <div class="comparison-container">
            <div class="comparison-item">
                <div class="comparison-title"> Método Moderno (Cargo 1.62+)</div>
                <div class="terminal-block">
$ cargo add rand
    Updating crates.io index
      Adding rand v0.8.5 to dependencies.
             Features:
             + alloc
             + getrandom
             + libc
             + rand_chacha
             + std
             + std_rng
                </div>
                <p>O comando <code>cargo add</code> adiciona automaticamente a dependência ao <code>Cargo.toml</code>.</p>
            </div>
            
            <div class="comparison-item">
                <div class="comparison-title"> Método Manual</div>
                <div class="code-block">
<span class="comment"># Em Cargo.toml</span>
[dependencies]
rand = "0.8.5"
serde = { version = "1.0", features = ["derive"] }
tokio = { version = "1.0", features = ["full"] }
                </div>
                <p>Você também pode editar o <code>Cargo.toml</code> manualmente para ter mais controle sobre features e versões.</p>
            </div>
        </div>

        <h2 class="section-subtitle">Exemplo Prático: Gerando Números Aleatórios</h2>
        
        <p>Vamos usar a crate <code>rand</code> para gerar números aleatórios:</p>
        
        <div class="terminal-block">
$ cargo add rand
</div>
        
        <p>Agora podemos usar a crate no nosso código:</p>
        
        <div class="code-block">
use rand::Rng; <span class="comment">// Importa o trait Rng</span>

fn main() {
    <span class="comment">// Gera um número entre 1 e 100 (inclusivo)</span>
    let numero_secreto = rand::thread_rng().gen_range(1..=100);
    println!("Número aleatório: {}", numero_secreto);
    
    <span class="comment">// Gera um booleano aleatório</span>
    let moeda = rand::thread_rng().gen_bool(0.5);
    println!("Moeda: {}", if moeda { "Cara" } else { "Coroa" });
    
    <span class="comment">// Gera um float entre 0.0 e 1.0</span>
    let probabilidade: f64 = rand::thread_rng().gen();
    println!("Probabilidade: {:.2}", probabilidade);
    
    <span class="comment">// Escolhe um elemento aleatório de um array</span>
    let cores = ["vermelho", "azul", "verde", "amarelo"];
    let cor_aleatoria = cores.choose(&mut rand::thread_rng()).unwrap();
    println!("Cor escolhida: {}", cor_aleatoria);
}
        </div>

        <h2 class="section-subtitle">Como o Cargo Gerencia Dependências</h2>
        
        <div class="rules-container">
            <div class="rule-item">
                <div class="rule-icon"><i class="fas fa-download"></i></div>
                <div><strong>Download automático</strong> - Cargo baixa todas as dependências necessárias</div>
            </div>
            <div class="rule-item">
                <div class="rule-icon"><i class="fas fa-hammer"></i></div>
                <div><strong>Compilação inteligente</strong> - Compila apenas o que mudou</div>
            </div>
            <div class="rule-item">
                <div class="rule-icon"><i class="fas fa-tags"></i></div>
                <div><strong>Versionamento semântico</strong> - Usa SemVer para compatibilidade</div>
            </div>
            <div class="rule-item">
                <div class="rule-icon"><i class="fas fa-lock"></i></div>
                <div><strong>Cargo.lock</strong> - Garante builds reproduzíveis</div>
            </div>
        </div>

        <h3>Entendendo o Cargo.lock</h3>
        
        <p>Quando você executa <code>cargo build</code> pela primeira vez, o Cargo cria um arquivo <code>Cargo.lock</code>:</p>
        
        <div class="code-block">
<span class="comment"># Cargo.lock (gerado automaticamente)</span>
[[package]]
name = "rand"
version = "0.8.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "34af8d1a0e25924bc5b7c43c079c942339d8f0a8b57c39049bef581b46327404"
dependencies = [
 "libc",
 "rand_chacha",
 "rand_core",
]
        </div>
        
        <div class="info-box tip">
            <h4><i class="fas fa-lightbulb"></i> Cargo.toml vs Cargo.lock</h4>
            <ul>
                <li><strong>Cargo.toml</strong>: Você edita, especifica dependências e versões</li>
                <li><strong>Cargo.lock</strong>: Cargo gera, versões exatas para builds reproduzíveis</li>
                <li><strong>Versionamento</strong>: Inclua Cargo.lock no Git para aplicações, exclua para bibliotecas</li>
            </ul>
        </div>

        <h2 class="section-subtitle">Crates Populares por Categoria</h2>
        
        <div class="two-columns">
            <div>
                <h3>1 Desenvolvimento Web</h3>
                <ul>
                    <li><strong>axum</strong> - Framework web moderno e ergonômico</li>
                    <li><strong>warp</strong> - Framework web rápido e composável</li>
                    <li><strong>actix-web</strong> - Framework web de alta performance</li>
                    <li><strong>rocket</strong> - Framework web com foco em facilidade</li>
                </ul>
                
                <h3>2 Serialização</h3>
                <ul>
                    <li><strong>serde</strong> - Serialização/deserialização universal</li>
                    <li><strong>serde_json</strong> - Suporte JSON para serde</li>
                    <li><strong>toml</strong> - Parser para formato TOML</li>
                    <li><strong>csv</strong> - Leitura e escrita de CSV</li>
                </ul>
                
                <h3>3 Utilitários</h3>
                <ul>
                    <li><strong>clap</strong> - Parser de argumentos de linha de comando</li>
                    <li><strong>regex</strong> - Expressões regulares</li>
                    <li><strong>chrono</strong> - Manipulação de datas e horários</li>
                    <li><strong>uuid</strong> - Geração de UUIDs</li>
                </ul>
            </div>
            
            <div>
                <h3>4 Async/Concorrência</h3>
                <ul>
                    <li><strong>tokio</strong> - Runtime assíncrono</li>
                    <li><strong>async-std</strong> - Biblioteca padrão assíncrona</li>
                    <li><strong>rayon</strong> - Paralelismo de dados</li>
                    <li><strong>crossbeam</strong> - Ferramentas de concorrência</li>
                </ul>
                
                <h3>5 Banco de Dados</h3>
                <ul>
                    <li><strong>sqlx</strong> - Driver SQL assíncrono</li>
                    <li><strong>diesel</strong> - ORM seguro e extensível</li>
                    <li><strong>redis</strong> - Cliente Redis</li>
                    <li><strong>mongodb</strong> - Driver MongoDB</li>
                </ul>
                
                <h3>6 Testes e Debugging</h3>
                <ul>
                    <li><strong>criterion</strong> - Benchmarking estatístico</li>
                    <li><strong>proptest</strong> - Testes baseados em propriedades</li>
                    <li><strong>env_logger</strong> - Logging configurável</li>
                    <li><strong>tracing</strong> - Instrumentação estruturada</li>
                </ul>
            </div>
        </div>

        <h2 class="section-subtitle">Exemplo Avançado: Cliente HTTP</h2>
        
        <p>Vamos criar um cliente HTTP simples usando a crate <code>reqwest</code>:</p>
        
        <div class="terminal-block">
$ cargo add reqwest --features json
$ cargo add tokio --features full
$ cargo add serde --features derive
</div>
        
        <div class="code-block">
use reqwest;
use serde::{Deserialize, Serialize};
use std::collections::HashMap;

#[derive(Serialize, Deserialize, Debug)]
struct Post {
    id: u32,
    title: String,
    body: String,
    #[serde(rename = "userId")]
    user_id: u32,
}

#[tokio::main]
async fn main() -> Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    <span class="comment">// GET: Buscar um post</span>
    let post: Post = reqwest::get("https://jsonplaceholder.typicode.com/posts/1")
        .await?
        .json()
        .await?;
    
    println!("Post recebido: {:#?}", post);
    
    <span class="comment">// POST: Criar um novo post</span>
    let novo_post = Post {
        id: 0, <span class="comment">// Será definido pelo servidor</span>
        title: "Meu Post em Rust".to_string(),
        body: "Este post foi criado usando Rust!".to_string(),
        user_id: 1,
    };
    
    let client = reqwest::Client::new();
    let resposta = client
        .post("https://jsonplaceholder.typicode.com/posts")
        .json(&novo_post)
        .send()
        .await?;
    
    println!("Status: {}", resposta.status());
    
    let post_criado: Post = resposta.json().await?;
    println!("Post criado: {:#?}", post_criado);
    
    Ok(())
}
        </div>

        <h2 class="section-subtitle">Features: Compilação Condicional</h2>
        
        <p>Muitas crates oferecem <strong>features</strong> opcionais para reduzir o tamanho do binário final:</p>
        
        <div class="code-block">
<span class="comment"># Em Cargo.toml</span>
[dependencies]
serde = { version = "1.0", features = ["derive"] }
tokio = { version = "1.0", features = ["rt-multi-thread", "net", "io-util"] }
reqwest = { version = "0.11", features = ["json", "rustls-tls"], default-features = false }
        </div>
        
        <div class="info-box">
            <h4><i class="fas fa-puzzle-piece"></i> Sobre Features</h4>
            <ul>
                <li><strong>default-features = false</strong>: Desabilita features padrão</li>
                <li><strong>features = [...]</strong>: Habilita features específicas</li>
                <li><strong>optional = true</strong>: Torna a dependência opcional</li>
                <li>Use <code>cargo doc --open</code> para ver features disponíveis</li>
            </ul>
        </div>

        <h2 class="section-subtitle">Comandos Úteis do Cargo</h2>
        
        <div class="code-block">
<span class="comment"># Adicionar dependência</span>
cargo add nome_da_crate
cargo add serde --features derive

<span class="comment"># Remover dependência</span>
cargo remove nome_da_crate

<span class="comment"># Atualizar dependências</span>
cargo update

<span class="comment"># Mostrar árvore de dependências</span>
cargo tree

<span class="comment"># Verificar dependências desatualizadas</span>
cargo outdated

<span class="comment"># Auditar dependências por vulnerabilidades</span>
cargo audit

<span class="comment"># Limpar cache de dependências</span>
cargo clean

<span class="comment"># Gerar documentação incluindo dependências</span>
cargo doc --open
        </div>

        <h2 class="section-subtitle">Criando Sua Própria Crate</h2>
        
        <p>Você também pode criar e publicar suas próprias crates:</p>
        
        <div class="terminal-block">
# Criar uma biblioteca
$ cargo new minha_lib --lib

# Estrutura criada:
minha_lib/
├── Cargo.toml
└── src/
    └── lib.rs
</div>
        
        <div class="code-block">
<span class="comment">// src/lib.rs</span>
/// Soma dois números
/// 
/// # Exemplos
/// 
/// ```
/// use minha_lib::somar;
/// 
/// assert_eq!(somar(2, 3), 5);
/// ```
pub fn somar(a: i32, b: i32) -> i32 {
    a + b
}

/// Multiplica dois números
pub fn multiplicar(a: i32, b: i32) -> i32 {
    a * b
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn teste_somar() {
        assert_eq!(somar(2, 3), 5);
    }

    #[test]
    fn teste_multiplicar() {
        assert_eq!(multiplicar(4, 5), 20);
    }
}
        </div>
        
        <div class="terminal-block">
# Testar a biblioteca
$ cargo test

# Gerar documentação
$ cargo doc --open

# Publicar no crates.io (após configurar conta)
$ cargo publish
</div>

        <h2 class="section-subtitle">Workspaces: Projetos Multi-Crate</h2>
        
        <p>Para projetos grandes, você pode usar <strong>workspaces</strong> para organizar múltiplas crates:</p>
        
        <div class="code-block">
<span class="comment"># Cargo.toml na raiz do workspace</span>
[workspace]
members = [
    "frontend",
    "backend", 
    "shared",
]

<span class="comment"># Dependências compartilhadas</span>
[workspace.dependencies]
serde = { version = "1.0", features = ["derive"] }
tokio = { version = "1.0", features = ["full"] }
        </div>
        
        <div class="terminal-block">
# Estrutura do workspace
meu_projeto/
├── Cargo.toml          # Workspace root
├── frontend/
│   ├── Cargo.toml
│   └── src/
├── backend/
│   ├── Cargo.toml
│   └── src/
└── shared/
    ├── Cargo.toml
    └── src/
</div>

        <div class="info-box">
            <h4><i class="fas fa-graduation-cap"></i> Você Aprendeu</h4>
            <ul>
                <li><strong>Crates</strong> são bibliotecas Rust disponíveis em crates.io</li>
                <li>Use <code>cargo add</code> para adicionar dependências facilmente</li>
                <li><strong>Features</strong> permitem compilação condicional e otimização</li>
                <li><strong>Cargo.lock</strong> garante builds reproduzíveis</li>
                <li>Rust tem um ecossistema rico com crates para quase tudo</li>
                <li>Você pode criar e publicar suas próprias crates</li>
                <li><strong>Workspaces</strong> organizam projetos multi-crate</li>
            </ul>
        </div>

        <div class="nav-buttons">
            <a href="testes.html" class="nav-button">
                <i class="fas fa-arrow-left"></i> Testes
            </a>
            <a href="recursos.html" class="nav-button">
                Recursos <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Tutorial de Rust.</p>
        </div>
    </footer>
</body>
</html>

